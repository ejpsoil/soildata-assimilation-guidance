<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>eSOTER to INSPIRE Soil model with HALE Studio – Soil data guidance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-ed96de9b727972fe78a7b5d16c58bf87.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-abe27cf03e924cf59ef884a22787a831.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../style/styles.css">
</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="https://ejpsoil.eu" class="navbar-brand navbar-brand-logo">
    <img src="https://avatars.githubusercontent.com/u/121284180?s=200&amp;v=4" alt="EJPSoil website" class="navbar-logo light-content">
    <img src="https://avatars.githubusercontent.com/u/121284180?s=200&amp;v=4" alt="EJPSoil website" class="navbar-logo dark-content">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../identification.html"> 
<span class="menu-text">Identification</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../etl.html"> 
<span class="menu-text">Harmonization</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../codelists.html"> 
<span class="menu-text">Code lists</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../metadata.html"> 
<span class="menu-text">Discovery</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../view.html"> 
<span class="menu-text">View</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../download.html"> 
<span class="menu-text">Download</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../QOS.html"> 
<span class="menu-text">QOS</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../utils/index.html"> 
<span class="menu-text">Utilities &amp; Cookbooks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../glossary.html"> 
<span class="menu-text">Glossary</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#contents-of-the-recipe" id="toc-contents-of-the-recipe" class="nav-link active" data-scroll-target="#contents-of-the-recipe">Contents of the recipe</a></li>
  <li><a href="#soter-database" id="toc-soter-database" class="nav-link" data-scroll-target="#soter-database">SOTER Database</a></li>
  <li><a href="#preparing-the-data" id="toc-preparing-the-data" class="nav-link" data-scroll-target="#preparing-the-data">Preparing the data</a></li>
  <li><a href="#install-hale-studio" id="toc-install-hale-studio" class="nav-link" data-scroll-target="#install-hale-studio">Install Hale Studio</a></li>
  <li><a href="#define-harmonization-rules" id="toc-define-harmonization-rules" class="nav-link" data-scroll-target="#define-harmonization-rules">Define harmonization rules</a>
  <ul class="collapse">
  <li><a href="#join-tables" id="toc-join-tables" class="nav-link" data-scroll-target="#join-tables">Join tables</a></li>
  <li><a href="#link-or-embed-and-identification" id="toc-link-or-embed-and-identification" class="nav-link" data-scroll-target="#link-or-embed-and-identification">Link or embed and identification?</a></li>
  </ul></li>
  <li><a href="#codelist-mappings" id="toc-codelist-mappings" class="nav-link" data-scroll-target="#codelist-mappings">Codelist Mappings</a></li>
  <li><a href="#anytype-in-xsd" id="toc-anytype-in-xsd" class="nav-link" data-scroll-target="#anytype-in-xsd">Anytype in XSD</a></li>
  <li><a href="#export-gml" id="toc-export-gml" class="nav-link" data-scroll-target="#export-gml">Export GML</a></li>
  <li><a href="#export-geopackage" id="toc-export-geopackage" class="nav-link" data-scroll-target="#export-geopackage">Export GeoPackage</a></li>
  <li><a href="#validate-gml" id="toc-validate-gml" class="nav-link" data-scroll-target="#validate-gml">Validate GML</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/ejpsoil/soildata-assimilation-guidance/edit/main/docs/cookbook/hale-studio.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ejpsoil/soildata-assimilation-guidance/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">eSOTER to INSPIRE Soil model with HALE Studio</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>HALE Studio aims to enable users to set up a harmonization workflow on datasets from a local model to a common model, such as INSPIRE. The user interface presents the model of the source dataset (derived from database) on the left and the target model on the right (derived from xml schema). Conversion rules are defined by selecting similar properties on both sides.</p>
<p>The open source software has been developed in the scope of a European Research project, HUMBOLDT (2006) and is currently maintained by a company called <a href="https://wetransform.to">WeTransform</a> in Darmstad Germany. WeTransform hosts the Hale Studio <a href="http://help.halestudio.org/latest">user guide</a> and a <a href="https://discuss.wetransform.to">user forum</a>. The Git repository for Hale Studio is at https://github.com/halestudio/hale.</p>
<p>This recipe has been developed in the scope of a Masterclass on data assimilation within the <a href="https://ejpsoil.eu/">EJP Soil project</a> and builds on harmonization work performed in the scope of the <a href="https://www.isric.org/projects/soil-and-terrain-database-danube-basin">eDanube project</a>.</p>
<p>In this recipe we’ll harmonize a eSOTER database to the INSPIRE model. Read more about the INSPIRE Soil model in the relevant <a href="https://inspire.ec.europa.eu/id/document/tg/so">technical guidelines</a>. Some samples of harmonised INSPIRE soil data are available from these data providers:</p>
<ul>
<li><a href="https://fbinter.stadt-berlin.de/fb/atom/SO/SO_BoKw2015.zip">City of Berlin</a></li>
<li><a href="http://mapy.geoportal.gov.pl/wss/service/ATOM/httpauth/download/?fileId=3fe348acdbf4318c7d9c618e62cf6006&amp;name=wielkopolskie_5k.zip">wielkopolski region in Poland</a></li>
<li><a href="https://www.inspire-geoportal.lt/resources/atom/so/data/SO_INSPIRE2.zip">Lihuania</a> (1.6GB)</li>
</ul>
<section id="contents-of-the-recipe" class="level2">
<h2 class="anchored" data-anchor-id="contents-of-the-recipe">Contents of the recipe</h2>
<ul>
<li><a href="#soter-database">SOTER database</a></li>
<li><a href="#preparing-the-data">Preparing the data</a></li>
<li><a href="#install-hale-studio">Install &amp; get started with Hale Studio</a></li>
<li><a href="#define-harmonization-rules">Define harmonization rules</a></li>
<li><a href="#codelist-mappings">Codelist Mappings</a></li>
<li><a href="#anytype-in-xsd">Anytype in XSD</a></li>
<li><a href="#export-gml">Export GML</a></li>
<li><a href="#export-geopackage">Export GeoPackage</a></li>
<li><a href="#validate-gml">Validate GML</a></li>
</ul>
</section>
<section id="soter-database" class="level2">
<h2 class="anchored" data-anchor-id="soter-database">SOTER Database</h2>
<p>For this recipe we’re going to use the SOTER database of Cuba. Download the zip file from https://data.isric.org/geonetwork/srv/eng/catalog.search#/metadata/f31ac19f-67a4-4f64-94cc-d4f063ea9add.</p>
<p>The <a href="https://www.isric.org/explore/soter">SOTER programme</a> was initiated in 1986 by the Food and Agricultural Organization (FAO), the United Nations Environmental Programme and ISRIC, under the auspices of the International Soil Science Society. The aim of the programme was to develop a global SOTER database at scale 1:1 million that was supposed to be the successor of the FAO-UNESCO Soil Map of the World. A SOTER database with global coverage was never achieved, but SOTER databases were developed for various regions, countries and continents.</p>
<p>The picture below shows the database structure of a SOTER database. The database structure allows to store terrain, soil profile up to wet chemistry results.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/soter-schema.png" class="img-fluid figure-img"></p>
<figcaption>Soter schema</figcaption>
</figure>
</div>
<p>In this recipe we’re focussing on the <code>RepresentativeHorizonValues</code> table mostly, which contains observed properties for each horizon.</p>
</section>
<section id="preparing-the-data" class="level2">
<h2 class="anchored" data-anchor-id="preparing-the-data">Preparing the data</h2>
<p>Notice that, like many other soil databases, the observed soil property values are listed as columns for each horizon. The INSPIRE model instead uses the Observations and Measurments model, in which each observation is an individual entity which includes the feature of interest (e.g.&nbsp;<code>Horizon 2</code>), the observed property (e.g.&nbsp;<code>pH</code>), the result (e.g.&nbsp;<code>7.2</code>) and a procedure (e.g.&nbsp;<code>pHCaCl2</code>).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/obsmes.png" class="img-fluid figure-img"></p>
<figcaption>Observations and measurements, source 52North</figcaption>
</figure>
</div>
<p>A data transformation required for this step is challenging within Hale, but relatively easy within the database. So before starting up Hale we’ll make an initial transformation within the database.</p>
<p>The <a href="https://files.isric.org/public/soter/CU-SOTER.zip">SOTER zip file</a> contains a SQLite as well as a Access version of the database. In this recipe we’ll work with Access, but you can also use the SQLite version, in that case install for example <a href="https://sqlitebrowser.org/">SQLite browser</a> to interact with the database. Some of the queries may slightly vary between SQLite and Access.</p>
<p>Run the query below, to create a new <code>OBSERVATIONS</code> table.</p>
<p>In Access create a new <code>query</code> in <code>design view</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/query-design-view.png" class="img-fluid figure-img"></p>
<figcaption>Query design</figcaption>
</figure>
</div>
<p>Then open <code>SQL view</code>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/sql-view.png" class="img-fluid figure-img"></p>
<figcaption>SQL view</figcaption>
</figure>
</div>
<p>Run the query, by clicking <code>Run</code> in the <code>Query design</code> toolbar.</p>
<pre><code>SELECT * INTO OBSERVATIONS
FROM (Select HONU,PRID,'SCMO' as PARAM,SCMO as RESULT from RepresentativeHorizonValues where SCMO is not null union
Select HONU,PRID,'SCDR' as PARAM,SCDR as RESULT from RepresentativeHorizonValues where SCDR is not null union
Select HONU,PRID,'STGR' as PARAM,STGR as RESULT from RepresentativeHorizonValues where STGR is not null union
Select HONU,PRID,'STSI' as PARAM,STSI as RESULT from RepresentativeHorizonValues where STSI is not null union
Select HONU,PRID,'STTY' as PARAM,STTY as RESULT from RepresentativeHorizonValues where STTY is not null union
Select HONU,PRID,'SDVC' as PARAM,SDVC as RESULT from RepresentativeHorizonValues where SDVC is not null union
Select HONU,PRID,'SDCO' as PARAM,SDCO as RESULT from RepresentativeHorizonValues where SDCO is not null union
Select HONU,PRID,'SDME' as PARAM,SDME as RESULT from RepresentativeHorizonValues where SDME is not null union
Select HONU,PRID,'SDFI' as PARAM,SDFI as RESULT from RepresentativeHorizonValues where SDFI is not null union
Select HONU,PRID,'SDVF' as PARAM,SDVF as RESULT from RepresentativeHorizonValues where SDVF is not null union
Select HONU,PRID,'SDTO' as PARAM,SDTO as RESULT from RepresentativeHorizonValues where SDTO is not null union
Select HONU,PRID,'STPC' as PARAM,STPC as RESULT from RepresentativeHorizonValues where STPC is not null union
Select HONU,PRID,'CLPC' as PARAM,CLPC as RESULT from RepresentativeHorizonValues where CLPC is not null union
Select HONU,PRID,'PSCL' as PARAM,PSCL as RESULT from RepresentativeHorizonValues where PSCL is not null union
Select HONU,PRID,'BULK' as PARAM,BULK as RESULT from RepresentativeHorizonValues where BULK is not null union
Select HONU,PRID,'ELCO' as PARAM,ELCO as RESULT from RepresentativeHorizonValues where ELCO is not null union
Select HONU,PRID,'SSO4' as PARAM,SSO4 as RESULT from RepresentativeHorizonValues where SSO4 is not null union
Select HONU,PRID,'HCO3' as PARAM,HCO3 as RESULT from RepresentativeHorizonValues where HCO3 is not null union
Select HONU,PRID,'SCO3' as PARAM,SCO3 as RESULT from RepresentativeHorizonValues where SCO3 is not null union
Select HONU,PRID,'EXCA' as PARAM,EXCA as RESULT from RepresentativeHorizonValues where EXCA is not null union
Select HONU,PRID,'EXMG' as PARAM,EXMG as RESULT from RepresentativeHorizonValues where EXMG is not null union
Select HONU,PRID,'EXNA' as PARAM,EXNA as RESULT from RepresentativeHorizonValues where EXNA is not null union
Select HONU,PRID,'EXCK' as PARAM,EXCK as RESULT from RepresentativeHorizonValues where EXCK is not null union
Select HONU,PRID,'EXAL' as PARAM,EXAL as RESULT from RepresentativeHorizonValues where EXAL is not null union
Select HONU,PRID,'EXAC' as PARAM,EXAC as RESULT from RepresentativeHorizonValues where EXAC is not null union
Select HONU,PRID,'CECS' as PARAM,CECS as RESULT from RepresentativeHorizonValues where CECS is not null union
Select HONU,PRID,'TCEQ' as PARAM,TCEQ as RESULT from RepresentativeHorizonValues where TCEQ is not null union
Select HONU,PRID,'GYPS' as PARAM,GYPS as RESULT from RepresentativeHorizonValues where GYPS is not null union
Select HONU,PRID,'P2O5' as PARAM,P2O5 as RESULT from RepresentativeHorizonValues where P2O5 is not null union
Select HONU,PRID,'PRET' as PARAM,PRET as RESULT from RepresentativeHorizonValues where PRET is not null union
Select HONU,PRID,'FEDE' as PARAM,FEDE as RESULT from RepresentativeHorizonValues where FEDE is not null union
Select HONU,PRID,'PHAQ' as PARAM,PHAQ as RESULT from RepresentativeHorizonValues where PHAQ is not null union
Select HONU,PRID,'PHKC' as PARAM,PHKC as RESULT from RepresentativeHorizonValues where PHKC is not null union
Select HONU,PRID,'SONA' as PARAM,SONA as RESULT from RepresentativeHorizonValues where SONA is not null union
Select HONU,PRID,'SOCA' as PARAM,SOCA as RESULT from RepresentativeHorizonValues where SOCA is not null union
Select HONU,PRID,'SOMG' as PARAM,SOMG as RESULT from RepresentativeHorizonValues where SOMG is not null union
Select HONU,PRID,'SOLK' as PARAM,SOLK as RESULT from RepresentativeHorizonValues where SOLK is not null union
Select HONU,PRID,'SOCL' as PARAM,SOCL as RESULT from RepresentativeHorizonValues where SOCL is not null union
Select HONU,PRID,'FEPE' as PARAM,FEPE as RESULT from RepresentativeHorizonValues where FEPE is not null union
Select HONU,PRID,'ALDE' as PARAM,ALDE as RESULT from RepresentativeHorizonValues where ALDE is not null union
Select HONU,PRID,'CLAY' as PARAM,CLAY as RESULT from RepresentativeHorizonValues where CLAY is not null union
Select HONU,PRID,'TOTC' as PARAM,TOTC as RESULT from RepresentativeHorizonValues where TOTC is not null union
Select HONU,PRID,'TOTN' as PARAM,TOTN as RESULT from RepresentativeHorizonValues where TOTN is not null  
);</code></pre>
<p>Verify that a new table <code>OBSERVATIONS</code> is available and that it is populated.</p>
</section>
<section id="install-hale-studio" class="level2">
<h2 class="anchored" data-anchor-id="install-hale-studio">Install Hale Studio</h2>
<p>Download and install Hale Studio from github. There are <a href="https://github.com/halestudio/hale/releases/tag/4.1.0">installers for windows, linux and apple</a>. Kate Lyndegaard from WeTransform published a nice overview of Hale Studio at https://www.youtube.com/watch?v=BKNMV-Jp9HM&amp;t=332s.</p>
<ul>
<li>First create a new project</li>
<li>Import the SOTER database as <code>source schema</code>.</li>
<li>Import the same database file again as ‘source data’.</li>
<li>Repeat these 2 steps for the Cuba shapefile, available in the GIS folder of the zip file</li>
<li>Load the INSPIRE Soil model as a target schema. Load the latest version of the model from https://inspire.ec.europa.eu/schemas/so/4.0/Soil.xsd (<code>from url</code> tab, click <code>detect</code> after entering the url).</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/hale-load-target.png" class="img-fluid figure-img"></p>
<figcaption>Load target</figcaption>
</figure>
</div>
</section>
<section id="define-harmonization-rules" class="level2">
<h2 class="anchored" data-anchor-id="define-harmonization-rules">Define harmonization rules</h2>
<p>We’ll go through some cases to highlight some of the features, we’ll not produce a full mapping.</p>
<section id="join-tables" class="level3">
<h3 class="anchored" data-anchor-id="join-tables">Join tables</h3>
<p>In order to link the geometries from the shapefile to the SOTER data, we’ll use a table join. On the left column, select the shapefile as well as the <code>terrain</code>, <code>soils</code> and <code>soilscomponent</code> tables (ctrl-click). On the right colum select the SoilBody type. Now click the blue arrow in the middle and select the <code>join</code> method.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/hale-join.png" class="img-fluid figure-img"></p>
<figcaption>Hale join</figcaption>
</figure>
</div>
</section>
<section id="link-or-embed-and-identification" class="level3">
<h3 class="anchored" data-anchor-id="link-or-embed-and-identification">Link or embed and identification?</h3>
<p>XML allows to embed a property or to reference the value of the property elsewhere. An example; both snippets below have the same meaning, the first is easier to read, the second is easier to handle by software (prevent duplication).</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">person</span><span class="ot"> role=</span><span class="st">"student"</span><span class="ot"> name=</span><span class="st">"Peter"</span>&gt;</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">memberOf</span>&gt;</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>        &lt;<span class="kw">class</span><span class="ot"> name=</span><span class="st">"2B"</span>&gt;</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>            &lt;<span class="kw">hasMember</span>&gt;</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>                &lt;<span class="kw">person</span><span class="ot"> role=</span><span class="st">"teacher"</span><span class="ot"> name=</span><span class="st">"Cynthia"</span>&gt;</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>            &lt;/<span class="kw">hasMember</span>&gt;</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        &lt;/<span class="kw">class</span>&gt;</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">memberOf</span>&gt;</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">person</span>&gt;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>And</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">person</span><span class="ot"> role=</span><span class="st">"student"</span><span class="ot"> name=</span><span class="st">"Peter"</span><span class="ot"> gml:id=</span><span class="st">"#student-peter"</span>&gt;</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">memberOf</span><span class="ot"> xlink:href=</span><span class="st">"#class-2b"</span>&gt;</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">person</span>&gt;</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">person</span><span class="ot"> role=</span><span class="st">"teacher"</span><span class="ot"> name=</span><span class="st">"Cynthia"</span><span class="ot"> gml:id=</span><span class="st">"#teacher-cynthia"</span>&gt;</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">memberOf</span><span class="ot"> xlink:href=</span><span class="st">"#class-2b"</span>&gt;</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">person</span>&gt;</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">class</span><span class="ot"> name=</span><span class="st">"2B"</span><span class="ot"> gml:id=</span><span class="st">"#class-2b"</span>/&gt;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>A good practice is to add reverse links to the second snippet:</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="sourceCode xml code-with-copy"><code class="sourceCode xml"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>&lt;<span class="kw">class</span><span class="ot"> name=</span><span class="st">"2B"</span><span class="ot"> gml:id=</span><span class="st">"#class-2b"</span>&gt;</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">hasMember</span><span class="ot"> xlink:href=</span><span class="st">"#teacher-cynthia"</span><span class="er">/</span> &gt;</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>    &lt;<span class="kw">hasMember</span><span class="ot"> xlink:href=</span><span class="st">"#student-peter"</span> /&gt;</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>&lt;/<span class="kw">class</span>&gt;</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Both approaches are supported and can be combined in Hale Studio, but you have to consider upfront which approach to use when. The first approach becomes quite complex if the levels of nesting increase.</p>
<p>A suggestion from our side; define Plot, Profile, OM_Observation and Laboratory as root types and embed other types.</p>
</section>
</section>
<section id="codelist-mappings" class="level2">
<h2 class="anchored" data-anchor-id="codelist-mappings">Codelist Mappings</h2>
<p>A common challenge in harmonization is the adoption and <a href="../cookbook/code-listsExtension.html">extension of common codelists</a>. Hale Studio facilitates the codelist mapping with the possibility to import codelists from the INSPIRE registry and the possibility to define a mapping file to map a local code to a common code.</p>
<p>First let’s import a codelist from the INSPIRE registry.</p>
<ul>
<li>In file &gt; import &gt; Codelist, select <code>Import from INSPIRE registry</code></li>
<li>Import the <a href="https://inspire.ec.europa.eu/codelist/SoilProfileParameterNameValue">SoilProfileParameterNameValue</a> codelist</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/hale-codelists.png" class="img-fluid figure-img"></p>
<figcaption>Import a codelist in Hale</figcaption>
</figure>
</div>
<p>Hale studio supports the INSPIRE registry xml format as well as codelists based on the SKOS ontology. However SKOS codelists should be encoded as RDF/XML. In order to load the <a href="https://github.com/rapw3k/glosis/blob/master/glosis_cl.ttl">GLOSIS codelists</a>, which are encoded as turtle, you can use a python snippet below to convert it to RDF/XML first.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> rdflib <span class="im">import</span> Graph</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> Graph()</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>g.parse(<span class="st">"https://raw.githubusercontent.com/rapw3k/glosis/master/glosis_procedure.ttl"</span>,<span class="bu">format</span><span class="op">=</span><span class="st">'ttl'</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>g.serialize(destination<span class="op">=</span><span class="st">'output.xml'</span>, <span class="bu">format</span><span class="op">=</span><span class="st">'xml'</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<p>Or use an online conversion tool such as <a href="https://issemantic.net/rdf-converter">https://issemantic.net/rdf-converter</a>.</p>
<p>Now assign a mapping from local values to this codelist.</p>
<ul>
<li>Select the observed property (bulkdens, organic matter, …) on the source model</li>
<li>On target model select the <code>href</code> attribute of the <code>observedProperty</code> of the <code>OM_Observation</code></li>
<li>Click the blue button and select the <code>classification</code> item</li>
<li>Proceed to second screen and click the second button <code>Attempt to fill source...</code>, the unique values of the source data are displayed</li>
<li>Double click the empty value next to the first value, on the panel select the button to select a codelist</li>
<li>Select the codelist, notice the pull down is now populated, select a value from the pulldown</li>
<li>Continue the mapping for each of the values</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/hale-select-code.png" class="img-fluid figure-img"></p>
<figcaption>select a concept from list</figcaption>
</figure>
</div>
<ul>
<li>In case you can’t find a relevant target value for a source value, then have a look at the <a href="../cookbook/code-listsExtension.html">extending codelist recipe</a>.</li>
</ul>
</section>
<section id="anytype-in-xsd" class="level2">
<h2 class="anchored" data-anchor-id="anytype-in-xsd">Anytype in XSD</h2>
<p>XSD allows to leave the type of a property as <code>any</code>. From a standardisation perspective, this is not optimal, because every developer may implement a different type for that field. In the INSPRE Soil theme this challenge is very obvious because the type of the result property of an observation is defined as <code>any</code>. Hale Studio is not able to process <code>anytype</code> fields by default. Instead you have to add below snippet to the <code>eu.esdihumboldt.hale.io.schema.read.target</code> resource of the <code>project.halex</code> file, to map the any field to a CharacterString.</p>
<pre><code> &lt;complex-setting name="customTypeContent"&gt;
    &lt;xsd:typeContentConfig xmlns:xsd="http://www.esdi-humboldt.eu/hale/io/xsd"&gt;
        &lt;core:list xmlns:core="http://www.esdi-humboldt.eu/hale/core"&gt;
            &lt;core:entry&gt;
                &lt;xsd:association&gt;
                    &lt;xsd:property&gt;
                        &lt;core:list&gt;
                            &lt;core:entry&gt;
                                &lt;core:name namespace="http://www.opengis.net/om/2.0"&gt;OM_ObservationType&lt;/core:name&gt;
                            &lt;/core:entry&gt;
                            &lt;core:entry&gt;
                                &lt;core:name namespace="http://www.opengis.net/om/2.0"&gt;result&lt;/core:name&gt;
                            &lt;/core:entry&gt;
                        &lt;/core:list&gt;
                    &lt;/xsd:property&gt;
                    &lt;xsd:config&gt;
                        &lt;xsd:typeContent mode="elements"&gt;
                            &lt;xsd:elements&gt;
                                &lt;core:list&gt;
                                    &lt;core:entry&gt;
                                        &lt;core:name namespace="http://www.isotc211.org/2005/gco"&gt;CharacterString&lt;/core:name&gt;
                                    &lt;/core:entry&gt;
                                &lt;/core:list&gt;
                            &lt;/xsd:elements&gt;
                        &lt;/xsd:typeContent&gt;
                    &lt;/xsd:config&gt;
                &lt;/xsd:association&gt;
            &lt;/core:entry&gt;
        &lt;/core:list&gt;
    &lt;/xsd:typeContentConfig&gt;
&lt;/complex-setting&gt;</code></pre>
</section>
<section id="export-gml" class="level2">
<h2 class="anchored" data-anchor-id="export-gml">Export GML</h2>
<ul>
<li>On the File menu, select <code>Export</code> &gt; <code>Transformed data</code>. A panel opens.</li>
<li>Select the <code>GML (FeatureCollection)</code> format.</li>
<li>Use one of projections suggested by INSPIRE, EPSG:4258 if you’re not sure which. Enable the EPSG prefix.</li>
<li>Finish the wizard, a GML file will be generated.</li>
</ul>
</section>
<section id="export-geopackage" class="level2">
<h2 class="anchored" data-anchor-id="export-geopackage">Export GeoPackage</h2>
<p>Hale Studio also facilitates an export to GeoPackage. Hale Studio is able to auto generate a relation data model based on the XSD schema. See also the recipe on <a href="../cookbook/glosis-db.html">GeoPackage</a>.</p>
<ul>
<li>From the format selection, select the GeoPackage format.</li>
<li>Select the relevant projection and finish.</li>
<li>Use <a href="https://dbeaver.io">DBeaver</a> or some other tool to view the outputs. DBeaver has a usefull ER-diagram vizualisation option.</li>
</ul>
</section>
<section id="validate-gml" class="level2">
<h2 class="anchored" data-anchor-id="validate-gml">Validate GML</h2>
<p>You can test the generated GML in the <a href="https://inspire.ec.europa.eu/validator/test-selection/index.html">INSPIRE Validator</a>. Select Dataset, and from <code>Annex III</code>, the Soil theme. Solve the <code>numeric riddle</code>, upload the GML file, add a label and start the test.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/ejpsoil\.github\.io\/soildata-assimilation-guidance\/");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/ejpsoil/soildata-assimilation-guidance/edit/main/docs/cookbook/hale-studio.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/ejpsoil/soildata-assimilation-guidance/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../about.html">
<p>About</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="../license.html">
<p>License</p>
</a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://cordis.europa.eu/project/id/862695">
<p><img style="width:80px;margin:5px 0px" src="https://ejpsoil.eu/fileadmin/_processed_/0/3/csm_Horizon_2020_funding_Thumbnail_a20cd538b7.jpg"></p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>
<script>var _paq = _paq || [];(function(){var u=(("https:" == document.location.protocol) ? "https://matomo.wur.nl/" : "http://matomo.wur.nl/");_paq.push(["setSiteId", "343"]);_paq.push(["setTrackerUrl", u+"matomo.php"]);_paq.push(["setDoNotTrack", 1]);_paq.push(["setCookieDomain", ".www.isric.org"]);if (!window.matomo_search_results_active) {_paq.push(["trackPageView"]);}_paq.push(["setIgnoreClasses", ["no-tracking","colorbox"]]);_paq.push(["enableLinkTracking"]);var d=document,g=d.createElement("script"),s=d.getElementsByTagName("script")[0];g.type="text/javascript";g.defer=true;g.async=true;g.src=u+"matomo.js";s.parentNode.insertBefore(g,s);})();</script>




</body></html>